
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>PocketBeagle Adapter board Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-page-toc/page-toc.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
        <link rel="stylesheet" href="../styles/website.css">
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="../M2VoltageMonitor/" />
    
    

    </head>
    <body>
        
<header class="main-header">
    <h1 class="main-header__title"><a href="https://macchina.cc" class="main-header__link"><img src="/images/logo.svg" alt="Macchina logo" class="main-header__logo"></a> Docs</h1>
</header>

<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" >
            
                <span>
            
                    
                    M2 Docs
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../m2/">
            
                <a href="../m2/">
            
                    
                    About M2
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../m2/versions.html">
            
                <a href="../m2/versions.html">
            
                    
                    Versions of M2
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../m2/disclaimer.html">
            
                <a href="../m2/disclaimer.html">
            
                    
                    Disclaimer
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="../m2/getting-started/">
            
                <a href="../m2/getting-started/">
            
                    
                    Getting Started
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.5" data-path="../m2/getting-started/arduino.html">
            
                <a href="../m2/getting-started/arduino.html">
            
                    
                    Arduino IDE Quick Start
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6" >
            
                <span>
            
                    
                    Detailed Reference
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.6.1" data-path="../m2/technical-references/installation.html">
            
                <a href="../m2/technical-references/installation.html">
            
                    
                    Installation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6.2" data-path="../m2/technical-references/processor.html">
            
                <a href="../m2/technical-references/processor.html">
            
                    
                    Processor
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.6.2.1" data-path="../m2/technical-references/pin-mapping.html">
            
                <a href="../m2/technical-references/pin-mapping.html">
            
                    
                    Pin Mapping
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.6.3" data-path="../m2/technical-references/interfaces.html">
            
                <a href="../m2/technical-references/interfaces.html">
            
                    
                    Automotive Interfaces
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6.4" data-path="../m2/technical-references/communication.html">
            
                <a href="../m2/technical-references/communication.html">
            
                    
                    Communication
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.6.4.1" data-path="../m2/build-something/cellular.html">
            
                <a href="../m2/build-something/cellular.html">
            
                    
                    Cellular
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.6.5" data-path="../m2/technical-references/power.html">
            
                <a href="../m2/technical-references/power.html">
            
                    
                    Power
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6.6" data-path="../m2/technical-references/memory.html">
            
                <a href="../m2/technical-references/memory.html">
            
                    
                    Storage/Memory
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6.7" data-path="../m2/technical-references/12vio.html">
            
                <a href="../m2/technical-references/12vio.html">
            
                    
                    12V IO
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6.8" data-path="../m2/technical-references/leds-buttons.html">
            
                <a href="../m2/technical-references/leds-buttons.html">
            
                    
                    LEDS/Buttons
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6.9" data-path="../m2/technical-references/enclosures.html">
            
                <a href="../m2/technical-references/enclosures.html">
            
                    
                    Enclosures
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6.10" data-path="../m2/technical-references/byob.html">
            
                <a href="../m2/technical-references/byob.html">
            
                    
                    Breakout Board
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6.11" data-path="../m2/technical-references/open-source.html">
            
                <a href="../m2/technical-references/open-source.html">
            
                    
                    Schematics and Source
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" >
            
                <span>
            
                    
                    Experimental Projects
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="1.3.1" data-path="./">
            
                <a href="./">
            
                    
                    PocketBeagle Adapter board
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../M2VoltageMonitor/">
            
                <a href="../M2VoltageMonitor/">
            
                    
                    Help Collect Voltage Data
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" >
            
                <span>
            
                    
                    SuperB Docs
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../superB/">
            
                <a href="../superB/">
            
                    
                    About SuperB
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../superB/hardware.html">
            
                <a href="../superB/hardware.html">
            
                    
                    Hardware
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../superB/getting-started/">
            
                <a href="../superB/getting-started/">
            
                    
                    Getting Started
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" >
            
                <span>
            
                    
                    Flashing SuperB with USB Adapter Board
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.4.1" data-path="../superB/flashing/esp.html">
            
                <a href="../superB/flashing/esp.html">
            
                    
                    Using ESP Tool
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4.2" data-path="../superB/flashing/arduino.html">
            
                <a href="../superB/flashing/arduino.html">
            
                    
                    Using Arduino IDE
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.5" >
            
                <span>
            
                    
                    Flashing SuperB with M2
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.5.1" data-path="../superB/flashing/arduinoM2.html">
            
                <a href="../superB/flashing/arduinoM2.html">
            
                    
                    Using Arduino IDE
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.6" data-path="../superB/getting-started/atCommands.html">
            
                <a href="../superB/getting-started/atCommands.html">
            
                    
                    Sending AT Commands
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.7" data-path="../superB/projects/ok_google_start_my_car.html">
            
                <a href="../superB/projects/ok_google_start_my_car.html">
            
                    
                    "OK Google, start my car!"
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                

                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >PocketBeagle Adapter board</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="pocketbeagle--m2--adapterbeta">PocketBeagle + M2 + Adapter(BETA)</h1>
<p>This project shows how to interface the PocketBeagle to your car&apos;s OBD port through the Macchina M2 interface and an adapter board.</p>
<p>Note: this project is early in development. This page contains documentation for basic setup of PocketBeagle + M2 Interface board + Adapter board)</p>
<p><img src="../images/IMG_6524_docs.png" width="640"></p>
<h2 id="parts">Parts:</h2>
<ul>
<li><a href="https://beagleboard.org/pocket" target="_blank">PocketBeagle</a></li>
<li><a href="https://www.macchina.cc/content/interface-board-utd" target="_blank">M2 Interface board</a></li>
<li>PocketBeagle/M2 Adapter board (limited availability - contact us if interested in this project)</li>
</ul>
<p>The following parts are common and can be found from many sources/manufacturers. Links shown are the parts we used for this project.</p>
<ul>
<li><a href="https://www.amazon.com/dp/B001FXZTIY/ref=psdc_3015433011_t4_B00MHZ6UDC" target="_blank">4GB SD card</a></li>
<li><a href="https://www.amazon.com/gp/product/B00DQFGH80/ref=oh_aui_detailpage_o00_s00?ie=UTF8&amp;psc=1" target="_blank">Powered USB hub</a></li>
<li><a href="https://www.amazon.com/Edimax-EW-7811Un-150Mbps-Raspberry-Supports/dp/B003MTTJOY/ref=sr_1_1?ie=UTF8&amp;qid=1513258750&amp;sr=8-1&amp;keywords=Edimax+Network+EW-7811UN" target="_blank">WIFI dongle</a></li>
<li><a href="https://www.amazon.com/UGREEN-Adapter-Samsung-Controller-Smartphone/dp/B00LN3LQKQ/ref=sr_1_5?s=electronics&amp;ie=UTF8&amp;qid=1513361808&amp;sr=1-5&amp;keywords=usb+otg+adapter" target="_blank">OTG adapter</a></li>
</ul>
<h2 id="adapter-board">Adapter board:</h2>
<p>The adapter board plugs directly into the M2 Interface board and provides:</p>
<ol>
<li>Routing of power and signals from M2 Interface board to PocketBeagle.</li>
<li>Battery connector for standard 2Pin JST battery connector and single cell lithium battery.</li>
<li>USB host port (with ESD protection).</li>
<li>Voltage scaling for 6 Analog inputs.</li>
<li>Several 0 ohm jumpers to route signals as needed.</li>
</ol>
<p>PCB files are found at these links:</p>
<ul>
<li><a href="https://github.com/macchina/pocketbeagle-adapter-hardware/blob/master/SCH-01010%20R0%20SCHEM_RELEASE.PDF" target="_blank">Schematic</a></li>
<li><a href="https://github.com/macchina/pocketbeagle-adapter-hardware/blob/master/PCB-01010%20R0%20STUFFCHARTS.PDF" target="_blank">Part location file</a></li>
<li><a href="https://github.com/macchina/pocketbeagle-adapter-hardware/blob/master/PCB-01010%20R0%20PIN%20NUMBER%20CHART.PDF" target="_blank">Pin number file</a></li>
</ul>
<h2 id="pocketbeagle-setup">PocketBeagle Setup:</h2>
<h4 id="step-1-hook-stuff-up">Step 1: Hook stuff up.</h4>
<p>Plug the adapter PCB into the M2 interface board and plug the PocketBeagle into the adapter board. If you have a new PocketBeagle, you&apos;ll need to solder some headers onto it. Since the PocketBeagle is not keyed, be sure to plug it in so that the USB ports are on the same side.</p>
<p>Plug the OTG adapter into the Adapter board and the powered USB hub into that adapter. Plug the WIFI dongle into the hub. Your setup should look like this:</p>
<p><img src="../images/20171215_130917.jpg" width="640"></p>
<h4 id="step-2-create-a-bootable-sd-card">Step 2: Create a bootable SD card</h4>
<p>Follow instructions <a href="https://beagleboard.org/getting-started" target="_blank">here</a> to create a bootable SD card. Once you have a bootable SD card, plug it into the PocketBeagle.</p>
<p>Plug a microUSB cable into the PocketBeagle and your computer. After a minute or so, use your favorite terminal to ssh to 192.168.7.2</p>
<p>Login: <em>debian</em>
Password: <em>temppwd</em></p>
<h4 id="step-25-change-your-password-optional-but-recommended">Step 2.5: Change your password (optional but recommended)</h4>
<p>We want to make sure that others wont be able to access your device to do this the main thing we are going to do is change the root password.</p>
<pre><code>sudo passwd root
</code></pre><h4 id="step-3-connect-to-internet">Step 3: Connect to internet.</h4>
<p>First thing we&apos;ll want to do is connect to the internet to be able to download the latest packages. To do that, we&apos;ll use WIFI. Type the commands as shown below</p>
<pre><code>sudo connmanctl
connmanctl&gt; enable wifi
Enabled wifi
connmanctl&gt; scan wifi
Scan completed for wifi
connmanctl&gt; services
</code></pre><p>All of the hotspots that your setup can see will be listed here, and look something like this:</p>
<p>wifi_xxxxxx_xxxxxx_managed_psk</p>
<p>Run these commands to connect:</p>
<pre><code>connmanctl&gt; agent on

connmanctl&gt; connect wifi_xxxxxx_xxxxxx_managed_psk

Passphrase? xxxxxxxxxxx

connected wifi_xxxxxx_xxxxxx_managed_psk

connmanctl&gt; quit
</code></pre><p>You should now be connected to your local wifi. You can check that you have an IP address by typing the following in the terminal window:</p>
<pre><code>ifconfig
</code></pre><p>You should now see an IP address under wlan0 and you can now connect to this IP address in the future to program your PocketBeagle.</p>
<h4 id="step-4-install-updates-and-can-tools">Step 4: Install updates and CAN tools.</h4>
<p>Now we run a few commands to update the system and install CAN tools. Type this into the terminal:</p>
<pre><code>sudo apt update ; sudo apt upgrade
</code></pre><p>Follow directions during install - should take a couple minutes.</p>
<pre><code>sudo /opt/scripts/tools/update_kernel.sh
</code></pre><p>Follow directions during install - should take a couple minutes.</p>
<pre><code>sudo reboot
</code></pre><p>Now that everything is updated to latest versions, we&apos;ll install CAN tools:</p>
<pre><code>sudo apt-get update &amp;&amp; sudo apt-get install git
cd /tmp
git clone https://github.com/linux-can/can-utils.git
cd can-utils/
make
sudo make install
cd ~
</code></pre><p>Next we make sure the pins on the PocketBeagle are set up correctly as shown at this link:</p>
<p><a href="https://github.com/beagleboard/pocketbeagle/wiki/Peripherals#can" target="_blank">https://github.com/beagleboard/pocketbeagle/wiki/Peripherals#can</a></p>
<p>Type this into terminal:</p>
<pre><code>config-pin P1_28 can
config-pin P1_26 can
</code></pre><h4 id="step-5-print-out-can-messages">Step 5: print out CAN messages</h4>
<p>Next, we set up the CAN interface and turn it on. Note that we are setting rate at 500Kb/s here. Your car might be a different BAUD rate.</p>
<pre><code>sudo ip link set can0 type can bitrate 500000 listen-only on

sudo ifconfig can0 up
</code></pre><p>To see actual data, we need to do 2 things: 1. Plug M2/PocketBeagle into your car or an emulator (No need for hub, and WIFI dongle anymore - those can be unplugged) and 2. enter this command to print output to terminal screen:</p>
<pre><code>candump -cae can0,0:0,#FFFFFFFF
</code></pre><p>If everything is set up correctly, you should see something like this:</p>
<p><img src="../images/PB_CAN_dump.png" width="640"></p>
<p>While this looks pretty cool, it is hard to see what is going on. Press <kbd>CTRL</kbd>+<kbd>C</kbd> to end output to terminal.</p>
<p>Logging CAN data to a file makes it easier to analyze the data. To do that, use this command to log data to current working directory:</p>
<pre><code>candump -l any,0:0,#FFFFFFFF
</code></pre><h4 id="step-6-going-further">Step 6: Going further.</h4>
<p>Next steps for this program is setting up and using more sophisticated analysis tools.</p>
<p><em>Note: At the time of writing this, we were not able to get the WIFI adapter to work without the powered hub in place. Perhaps the USB port on PocketBeagle does not output enough current? M2 Interface board should supply up to 3A at 5V, so more investigation on this subject to follow</em></p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
<footer>
    Can't find what your are looking for?  <a href="https://github.com/macchina/docs/issues">Open an Issue on GitHub</a> or <a href="https://forum.macchina.cc/">ask on the Forum</a>.
    <br/><br/>
    This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.
    All code samples in this work are released to the public domain using the <a href="http://creativecommons.org/publicdomain/zero/1.0/">Creative Commons CC0 Public Domain Dedication</a>.
</footer>

            </div>

            
                
                
                <a href="../M2VoltageMonitor/" class="navigation navigation-next navigation-unique" aria-label="Next page: Help Collect Voltage Data">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"PocketBeagle Adapter board","level":"1.3.1","depth":2,"next":{"title":"Help Collect Voltage Data","level":"1.3.2","depth":2,"path":"M2VoltageMonitor/README.md","ref":"M2VoltageMonitor/README.md","articles":[]},"previous":{"title":"Experimental Projects","level":"1.3","depth":1,"ref":"","articles":[{"title":"PocketBeagle Adapter board","level":"1.3.1","depth":2,"path":"pb_adapter/README.md","ref":"pb_adapter/README.md","articles":[]},{"title":"Help Collect Voltage Data","level":"1.3.2","depth":2,"path":"M2VoltageMonitor/README.md","ref":"M2VoltageMonitor/README.md","articles":[]}]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["ga","custom-favicon","edit-link","page-toc"],"pluginsConfig":{"search":{},"page-toc":{"position":"before-first","selector":".markdown-section h1, .markdown-section h2, .markdown-section h3, .markdown-section h4","showByDefault":true},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"highlight":{},"favicon":"images/favicon.ico","custom-favicon":{},"ga":{"configuration":"auto","token":"UA-75126303-1"},"sharing":{"facebook":false,"twitter":false,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"edit-link":{"label":"Edit This Page","base":"https://github.com/macchina/docs/edit/master/"},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"index.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"./styles/website.css"}},"file":{"path":"pb_adapter/README.md","mtime":"2019-06-18T12:52:39.316Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2019-06-18T12:53:45.619Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>


        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-ga/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-edit-link/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-page-toc/anchor-3.1.1.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-page-toc/page-toc.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

